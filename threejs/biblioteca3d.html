<!DOCTYPE html>
<html>

  <link href='https://fonts.googleapis.com/css?family=Exo' rel='stylesheet'>


  
<head>
    <title>Exposición: El Cyborg Chamán</title>
 <link
    rel="shortcut icon"
    href="images/cyborgshaman.jpg"
  />

    <style>
        html,
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
	    font-family: 'Exo';font-size: 12px;
        }
	a {
	    color: #aaee55
	}

	.button {
	    /* position: fixed; */
	    left:10%;
	    top: 10%;
	    z-index: 100;
	}
	.basicmenu {
	    background-color: #114433;
	    color: #eee;
	    position: fixed;
	    left:5%;
	    top: 5%;
	    transparent: true;
	    opacity:0.8;
	    z-index: 100;
	}
	
    </style>
</head>

<body>
  <video id="video" width='1366' height='768' loop style="display:none"></video>
  
  
    <script src="js/three.js"></script>
    <script src="js/controls/OrbitControls.js"></script>
    <script src="js/csg.js"></script>
    <script src="js/THREE.CSG.js"></script>
    <script src="js/WebGL.js"></script>
 <!-- <script src="https://gist.github.com/XanderLuciano/5ce51976fd18beffdc118fd29b547c05.js"></script> -->

    <script>

      if (WEBGL.isWebGLAvailable() === false) {

            document.body.appendChild(WEBGL.getWebGLErrorMessage());

      }

      

      // Imágenes para proyectar en las paredes
      var paredFrontalImagen="images/cyborgshaman.jpg";
      
      //agregar video
      const video = document.getElementById( 'video' );
      //const videotexture = new THREE.VideoTexture( video );
      var usevideo=  1 ;//1 true, 0 false
      var videofile="output.mp4"

      //vars for mouse click detection
      var targetList = [];
      var projector, mouse = { x: 0, y: 0 };

      var historias={
	  h1: {
	      title:'Mrs. Saunders y su gallina con peluca',
	      story:'Estaba sentado en la terraza de mi café favorito, tomando un café y disfrutando del buen tiempo, cuando de pronto vi a una gallina con una peluca. Me quedé mirándola fijamente durante unos segundos, sin saber qué hacer. Luego me di cuenta de que era mi vecina, Mrs. Saunders. Ella siempre había sido un poco excentrica, pero nunca había visto nada igual.',
	      author:'openAl, 2022-08-26',
	      inspiration:'( madera naturaleza café gallina con peluca)'

	  },
	  h2: {
	      title:'La fiesta del duende supersónico',
	  },
	  h3: {
	      title:'El día más feliz de mi vida',
	  },
	  h4: {
	      title:'La cumbia del volcán',
	  },
	  h5: {
	      title:'El cielo es mi hogar',
	  },
	  h6: {
	      title:'Un día cualquiera en Suba',
	  },
	  h7: {
	      title:'La Prueba',
	  },
	  h8: {
	      title:'La duda de cada noche',
	  },
	  h9: {
	      title:'La niña del árbol',
	  },
	  h10: {
	      title:'Diario de Darío',
	  },
	  h11: {
	      title:'Anécdota de Ángela',
	  },
	  h12: {
	      title:'La chica de la bicicleta',
	  },
	  h13: {
	      title:'El baño de la tortuga fantasma',
	  },
	  
	  h14: {
	      title:'La mirada del perro',
	  },
	  h15: {
	      title:'El oasis',
	  },
	  h16: {
	      title:'Un día en la ciclovia',
	  },
	  h17: {
	      title:'Un día difícil',
	  },
	  h18: {
	      title:'La chica atada al árbol',
	  },
	  h19: {
	      title:'El vecindario',
	  },
	  h20: {
	      title:'La interrupción',
	  },
	  h21: {
	      title:'El niño del parque',
	  },
	  h22: {
	      title:'La caja mágica',
	  },
	  h23: {
	      title:'La brisa fresca',
	  },
	  h24: {
	      title:'El niño Jesús de la virgen María',
	  },
	  h25: {
	      title:'Danzar; Hadas en el jardín; El baile de la alegría',
	  },
	  
      }

      
      var scene, aspect, camera, renderer, controls, cyborg, Piso2, boxes;
      init();
      animate();

      function init() {
          if (WEBGL.isWebGLAvailable() === false) {
              document.body.appendChild(WEBGL.getWebGLErrorMessage());
          }
          //INICIALIZACIÓN
          scene = new THREE.Scene();
	  scene.background = new THREE.Color(0x2244aa);
          aspect = window.innerWidth / window.innerHeight;
          camera = new THREE.PerspectiveCamera(50, aspect, 0.1, 1000);
          renderer = new THREE.WebGLRenderer();
          renderer.setSize(window.innerWidth, window.innerHeight);
          document.body.appendChild(renderer.domElement);
          controls = new THREE.OrbitControls(camera, renderer.domElement);

	  controls.panSpeed= 1.8;
	  //controls.maxDistance=25;
	  controls.enableDamping=false;
	  controls.minPolarAngle=0;
	  
          //ELEMENTOS COMUNES
	  var pihalf=THREE.Math.degToRad(90);
          var origin = new THREE.Vector3(0, 0, 0);
          var x = new THREE.Vector3(1, 0, 0);
          var y = new THREE.Vector3(0, 1, 0);
          var z = new THREE.Vector3(0, 0, 1);
          var colorPared = new THREE.Color(0xffddaa);
          var colorLadrillo = new THREE.Color(0xaa4411);
          var colorPiso = new THREE.Color(0x999988);
          var colorVerde = new THREE.Color(0x026101);
          var colorAzul = new THREE.Color(0x021091);
          var colorOscuro = new THREE.Color(0x3f3f2c);
	  var colorVerdeOscuro = new THREE.Color(0x3f5f2c);

	  var intersected_object = 0;

	  
          
          //ROTARLAS PARA QUE QUEDEN EN EL ESPACIO ADECUADO
          

	  
   
	  //CREAR ILUMINACIÓN
          var ambient = new THREE.AmbientLight(0xbbbbff, 0.7);
          scene.add(ambient);
	  
	  var directionalLight1 = new THREE.DirectionalLight(0x335588, 0.5);
          directionalLight1.position.set(-1, 1, 1).normalize();
          scene.add(directionalLight1);

          var ambientout = new THREE.AmbientLight(0xbbbbff, 0.2);
	  ambientout.position.set(30, 50,20)
          scene.add(ambientout);
	  // hemiLight = new THREE.HemisphereLight( 0x0000ff, 0x008800, 0.6 );
	  // scene.add(hemiLight);


	  var moonLight = new THREE.SpotLight(0xffdd83, 2, 1000, 1.5, 0.5);
          moonLight.position.set(300, 500, 200);
          scene.add(moonLight);

 

	  
	  
	  
          //CREAR LOS MATERIALES
	  //box
          var materialNegro = new THREE.MeshStandardMaterial({
              color: 0x010101,
              roughness: 0.5,
	      metalness: 0.1,
          });
          var materialPared = new THREE.MeshStandardMaterial({
              color: colorPared,
              metalness: 0,
              roughness: 0.5,
	      
          });
                    
          var materialbomb = new THREE.MeshBasicMaterial({
              color: 0xffffaa
          });
	  
          //TEXTURAS
	  
          var woodBase = new THREE.TextureLoader().load('textures/ColorMad.jpg');
          var woodNormal = new THREE.TextureLoader().load('textures/NormalMad.jpg');
          var woodMaterial = new THREE.MeshStandardMaterial({
              map: woodBase,
              normalMap: woodNormal
          });
          
          var lightWoodBase = new THREE.TextureLoader().load('textures/lightWood.jpg');
          //var woodNormal = new THREE.TextureLoader().load('textures/NormalMad.jpg');
          var woodMaterial = new THREE.MeshStandardMaterial({
              map: lightWoodBase,
              normalMap: lightWoodBase
          });
	  
	  
	  
	  // // material pared izquierda
          //var patBase = new THREE.TextureLoader().load(paredIzquierdaImagen);
          var patNormal = new THREE.TextureLoader().load('textures/NormalPat.jpg');
          
          // var materialParedPuerta = new THREE.MeshStandardMaterial({
          //     //color: 0xffffff,
          //     roughness: 0.5,
	  //     metalness: 0.1,
          //     transparent: true,
          //     opacity: 0.8,
          //     map: patBase,
          //     normalMap: patNormal
          // });
	  
	  //material pared frontal
	  var projBase1 = new THREE.TextureLoader().load(paredFrontalImagen);

	  // in case of video
	  if (usevideo==1){
	      video.src = videofile;
	      video.load();
	      //video.play();

	      videoImage = document.createElement( 'canvas' );
	      videoImage.width = 1366;
	      videoImage.height = 768;
	      
	      videoImageContext = videoImage.getContext( '2d' );
	      // background color if no video present
	      videoImageContext.fillStyle = '#000000';
	      videoImageContext.fillRect( 0, 0, videoImage.width, videoImage.height );
	      

	      
	      videoTexture = new THREE.VideoTexture( videoImage );
	      videoTexture.minFilter = THREE.LinearFilter;
	      videoTexture.magFilter = THREE.LinearFilter;
	
	      var frontalTexture=videoTexture;
	  } else {
	      var frontalTexture=projBase1;
	  }
	  
	  var Proyeccion1 = new THREE.MeshStandardMaterial({
              //color: 0xffffff,
              roughness: 0.1,
	      metalness: 0.2,
              transparent: true,
              opacity: 0.8,
              map: projBase1,
              normalMap: patNormal
          });

	  
	  
	  //material pared derecha
          // var projBase2 = new THREE.TextureLoader().load(paredDerechaImagen);
	  // var Proyeccion2 = new THREE.MeshStandardMaterial({
          //     //color: 0xffffff,
          //     roughness: 0.1,
	  //     metalness: 0.2,
          //     //transparent: true,
          //     //opacity: 0.8,
          //     map: frontalTexture,
          //     //normalMap: patNormal
          // });

	  
	  
          var matPuerta = new THREE.MeshStandardMaterial({
              color: colorLadrillo,
              metalness: 0,
              roughness: 0.2,
              map: woodBase,
              normalMap: woodNormal,
          });
	  var materialBiblio = new THREE.MeshStandardMaterial({
              color: colorLadrillo,
              metalness: 0.3,
              roughness: 0.2,
              //map: woodBase,
              //normalMap: woodNormal,
          });
	  var materialGris = new THREE.MeshStandardMaterial({
              color: 0x666666,
              metalness: 0.3,
              roughness: 0.2,
              //map: woodBase,
              //normalMap: woodNormal,
          });

	  materialLadrillo=materialPared;
	  var materialVerde = new THREE.MeshStandardMaterial({
              color: colorVerde,
              metalness: 0,
              roughness: 0.6,
              //map: woodBase,
              //normalMap: woodNormal,
          });
	  
          var materialPiso = new THREE.MeshStandardMaterial({
              color: colorPiso,
              metalness: 0.2,
              //transparent: true,
              roughness: 0.1,
          });
          var materialPiso2 = new THREE.MeshStandardMaterial({
              color: colorVerdeOscuro,
              //metalness: 0,
              //transparent: true,
              roughness: 0.8,
          });
          var materialMadera = new THREE.MeshStandardMaterial({
              color: colorPiso,
              metalness: 0.2,
              //transparent: true,
              roughness: 0.1,
              map: lightWoodBase,
              normalMap: woodNormal,
          });


          var materialCristal= new THREE.MeshBasicMaterial({ 
              color: 0x9999aa , 
              side: THREE.DoubleSide, 
              transparent: true,
	      metalness: 0.8,
	      roughness: 0.1,
              opacity: 0.3
          });


//////////////////////////////////////////////////////////
	  
          //EXP MIO


	  // CSG
          // var box1 = new THREE.Mesh(boxGeometry);
          // var box2 = new THREE.Mesh(boxGeometry2);
          // box2.position.z = 1;
          // var box1CSG = THREE.CSG.fromMesh(box1);
          // var box2CSG = THREE.CSG.fromMesh(box2);
          // var result = box1CSG.subtract(box2CSG);
          // var pasillo = THREE.CSG.toMesh(result);



	  var size = 30;
          
          var divisions = size;
          
          //CREAR LAS GRILLAS PARA EL ESCENARIO
          // var arrowSize = 10;
	  // var axesHelper = new THREE.AxesHelper(arrowSize);
          // scene.add(axesHelper);
	  

	  var xsize = 100;//half size, auditorium 10=1m
	  var zsize = 180;//deep  
	  var gruesoPared = 2;//20cm
	  // var ground = -10;//20cm
	  


	  var ysize=38;
 	  var ysize2=26;
 	  


	  
          //CREAR LAS GEOMETRIAS
	  var Piso1 = new THREE.Object3D();
	  Piso2 = new THREE.Object3D();
	  
	  var planoVerde = new THREE.PlaneGeometry(6000, 6000);
          var pV = new THREE.Mesh(planoVerde, materialPiso2);
          pV.rotateX(-1.5708);
          //par2.rotateZ(-1.5708);
          pV.position.y = -10;
	  scene.add(pV);
          var pV2 = new THREE.Mesh(planoVerde, materialPiso2);
          pV2.rotateX(1.5708);
          //par2.rotateZ(-1.5708);
          pV2.position.y = -11;
	  scene.add(pV2);
	  

	  

	  //base
	  var baseGeometry = new THREE.BoxGeometry(2*xsize+10, 10, zsize);
	  var base0 = new THREE.Mesh(baseGeometry, materialPiso);
          base0.position.set(-5, -5, 0);
	  Piso1.add(base0);


	  var baseVerdeGeometry = new THREE.BoxGeometry(xsize+60-4, 10, 40-4);
	  var baseVerde = new THREE.Mesh(baseVerdeGeometry, materialVerde);
          baseVerde.position.set(xsize/2-30, -4.5, -zsize/2-20);
	  Piso1.add(baseVerde);

	  var basePatioGeometry = new THREE.BoxGeometry(2*xsize+10, 10, 40);
	  var basePatio = new THREE.Mesh(basePatioGeometry, materialPiso);
          basePatio.position.set(-5, -5, -zsize/2-20);
	  Piso1.add(basePatio);



	  var baseGeometry2 = new THREE.BoxGeometry(xsize, 4, zsize);
	  var basep2 = new THREE.Mesh(baseGeometry2, materialPiso);
          basep2.position.set(xsize/2, ysize, 0);
	  Piso2.add(basep2);

	  var basemediogeom = new THREE.BoxGeometry(50, 4, zsize-20);
	  var basemedio = new THREE.Mesh(basemediogeom, materialPiso);
          basemedio.position.set(-85, ysize2, -10);
	  Piso2.add(basemedio);


	  var basemedio2geom = new THREE.BoxGeometry(30, 4, zsize/2+12);
	  var basemedio2 = new THREE.Mesh(basemedio2geom, materialPiso);
          basemedio2.position.set(-45, ysize2, -6+0.25*zsize);
	  Piso2.add(basemedio2);
	  var basemedio3geom = new THREE.BoxGeometry(30, 4, zsize/2-54);
	  var basemedio3 = new THREE.Mesh(basemedio3geom, materialPiso);
          basemedio3.position.set(-15, ysize2, 27+ 0.25*zsize);
	  Piso2.add(basemedio3);


	  var basemedio4geom = new THREE.BoxGeometry(45, 4, zsize/2-26);
	  var basemedio4 = new THREE.Mesh(basemedio4geom, materialPiso);
          basemedio4.position.set(-45/2, ysize, -13 -0.25*zsize);
	  Piso2.add(basemedio4);
	  var basemedio5geom = new THREE.BoxGeometry(15, 4, zsize/2-26-16);
	  var basemedio5 = new THREE.Mesh(basemedio5geom, materialPiso);
          basemedio5.position.set(-15/2-45, ysize, -13 -0.25*zsize-8);
	  Piso2.add(basemedio5);

	  

	  var baseescalerageom = new THREE.BoxGeometry(30, 2, 16);
	  var baseescalera = new THREE.Mesh(baseescalerageom, materialPiso);
          baseescalera.position.set(-45, ysize2/2, +8-0.25*zsize);
	  Piso1.add(baseescalera);



	  var escalerasgeom = new THREE.BoxGeometry(15, 2, 3);// 4m back
	  var escaleras0 = new THREE.Mesh(escalerasgeom, materialPiso);
          escaleras0.position.set(0, 11, 1.5);
	  var escaleras1 = new THREE.Mesh(escalerasgeom, materialPiso);
          escaleras1.position.set(0, 9, 3+1.5);
	  var escaleras2 = new THREE.Mesh(escalerasgeom, materialPiso);
          escaleras2.position.set(0, 7, 6+1.5);
	  var escaleras3 = new THREE.Mesh(escalerasgeom, materialPiso);
          escaleras3.position.set(0, 5, 9+1.5);
	  var escaleras4 = new THREE.Mesh(escalerasgeom, materialPiso);
          escaleras4.position.set(0, 3, 12+1.5);
	  var escaleras5 = new THREE.Mesh(escalerasgeom, materialPiso);
          escaleras5.position.set(0, 1, 15+1.5);
	  
	  var escaleras = new THREE.Object3D();
	  escaleras.add(escaleras0);
	  escaleras.add(escaleras1);
	  escaleras.add(escaleras2);
	  escaleras.add(escaleras3);
	  escaleras.add(escaleras4);
	  escaleras.add(escaleras5);
	  
	  var escalerasmed = escaleras.clone();
	  var escalerastop = escaleras.clone();
	  escaleras.position.set(-45+15/2, 0, 16-0.25*zsize);
	  escalerasmed.rotateY(2*pihalf);
	  escalerasmed.position.set(-45-15/2, ysize2/2+1,34-0.25*zsize);
	  escalerastop.position.set(-45+15/2, ysize2, 16+2-0.25*zsize);
	  Piso1.add(escaleras);
	  Piso1.add(escalerasmed);
	  Piso2.add(escalerastop);
	  


	  
	  
	  var gridHelperXZ = new THREE.GridHelper(zsize, 0.5*zsize, colorOscuro, colorOscuro);
	  var gridHelperXZ2= new THREE.GridHelper(zsize, 0.5*zsize, colorOscuro, colorOscuro);
	  gridHelperXZ.rotateOnWorldAxis(y, pihalf);
          gridHelperXZ2.rotateOnWorldAxis(y, pihalf);
	  gridHelperXZ.position.set( -10-xsize+0.5*zsize, 0.1, 0);
	  gridHelperXZ2.position.set( +xsize-0.5*zsize, 0.1, 0);
	  

	  //gridHelperXZ.position.y = -14.99;
	  Piso1.add(gridHelperXZ);
	  Piso1.add(gridHelperXZ2);
	  


	  //auditorio
	  
	  var base1 = new THREE.BoxGeometry(xsize-20, 12, 40);// 4m back
	  var baseAudit = new THREE.Mesh(base1, materialPiso);
          baseAudit.position.set(0.5*xsize, 6, -0.5*zsize+20);
	  Piso1.add(baseAudit);
	  var base2 = new THREE.BoxGeometry(xsize, 12, 30);// 4m back
	  var baseAudit2 = new THREE.Mesh(base2, materialPiso);
          baseAudit2.position.set(0.5*xsize, 6, -0.5*zsize+15);
	  Piso1.add(baseAudit2);
	  
	  var escalasgeom = new THREE.BoxGeometry(10, 2, 2);// 4m back
	  var escalas = new THREE.Mesh(escalasgeom, materialPiso);
          escalas.position.set(5, 9, -0.5*zsize+31);
	  var escalas2 = new THREE.Mesh(escalasgeom, materialPiso);
          escalas2.position.set(5, 7, -0.5*zsize+33);
	  var escalas3 = new THREE.Mesh(escalasgeom, materialPiso);
          escalas3.position.set(5, 5, -0.5*zsize+35);
	  var escalas4 = new THREE.Mesh(escalasgeom, materialPiso);
          escalas4.position.set(5, 3, -0.5*zsize+37);
	  var escalas5 = new THREE.Mesh(escalasgeom, materialPiso);
          escalas5.position.set(5, 1, -0.5*zsize+39);
	  var escalasAudit = new THREE.Object3D();
	  escalasAudit.add(escalas);
	  escalasAudit.add(escalas2);
	  escalasAudit.add(escalas3);
	  escalasAudit.add(escalas4);
	  escalasAudit.add(escalas5);
	  Piso1.add(escalasAudit);
	  var escalasAudit2 = escalasAudit.clone();
	  escalasAudit2.position.set(xsize-10, 0, 0);
	  Piso1.add(escalasAudit2);

	  
	  //paredes laterales
	  var paredDerecha = new THREE.BoxGeometry(gruesoPared, ysize, zsize);
          var pared1 = new THREE.Mesh(paredDerecha, materialPared);
          pared1.position.set(xsize, 0.5*ysize, 0);
	  Piso1.add(pared1);

	  var pared1Up = new THREE.Mesh(paredDerecha, materialPared);
          pared1Up.position.set(xsize, ysize2+0.5*ysize, 0);
	  Piso2.add(pared1Up);

	  
	  var paredizqgeom = new THREE.BoxGeometry(gruesoPared, ysize2, gruesoPared+zsize-20);
          var paredizq = new THREE.Mesh(paredizqgeom, materialPared);
          paredizq.position.set(-xsize-10, 0.5*ysize2, -10);
	  Piso1.add(paredizq);


	  var paredizqup = new THREE.Mesh(paredizqgeom, materialPared);
          paredizqup.position.set(-xsize-10, 1.5*ysize2, -10);
	  Piso2.add(paredizqup);
	 
	  
	  //pared atras auditorio
	  var pared2geom = new THREE.BoxGeometry(xsize+gruesoPared, ysize, gruesoPared);
          var pared2 = new THREE.Mesh(pared2geom, materialPared);
          pared2.position.set(0.5*xsize, 0.5*ysize, -0.5*zsize);
	  Piso1.add(pared2);
          var pared2Up = new THREE.Mesh(pared2geom, materialPared);
          pared2Up.position.set(0.5*xsize, 0.5*ysize+ysize2, -0.5*zsize);
	  Piso2.add(pared2Up);

	  // pared adelante
	  var paredfgeom = new THREE.BoxGeometry(xsize + gruesoPared, 10, gruesoPared);
          var paredf = new THREE.Mesh(paredfgeom, materialPared);
          paredf.position.set(0.5*xsize, 5, 0.5*zsize);
	  Piso1.add(paredf);
	  
	  var paredf1geom = new THREE.BoxGeometry(20 + gruesoPared, ysize-10, gruesoPared);
          var paredf1 = new THREE.Mesh(paredf1geom, materialPared);
          paredf1.position.set(10, 5+ysize/2, 0.5*zsize);
	  Piso1.add(paredf1);
	  var paredf1upgeom = new THREE.BoxGeometry(20 + gruesoPared, ysize2, gruesoPared);
	  var paredf1up = new THREE.Mesh(paredf1upgeom, materialPared);
          paredf1up.position.set(10, ysize+ysize2/2, 0.5*zsize);
	  Piso2.add(paredf1up);

	  
	  var paredf2geom = new THREE.BoxGeometry(xsize-70 + gruesoPared, ysize-10, gruesoPared);
          var paredf2 = new THREE.Mesh(paredf2geom, materialPared);
          paredf2.position.set(35+xsize/2, 5+ysize/2, 0.5*zsize);
	  Piso1.add(paredf2);

	  var paredf2upgeom = new THREE.BoxGeometry(xsize-70 + gruesoPared, ysize2, gruesoPared);
          var paredf2up = new THREE.Mesh(paredf2upgeom, materialPared);
          paredf2up.position.set(35+xsize/2, ysize+ysize2/2, 0.5*zsize);
	  Piso2.add(paredf2up);


	  
	  var paredfizqgeom = new THREE.BoxGeometry(80 + gruesoPared, 12, gruesoPared);
	  var paredfizq = new THREE.Mesh(paredfizqgeom, materialPared);
          paredfizq.position.set(-70, 6, -20+0.5*zsize);
	  Piso1.add(paredfizq);

	  var paredfizqupgeom = new THREE.BoxGeometry(50 + gruesoPared, 12, gruesoPared);
	  var paredfizqup = new THREE.Mesh(paredfizqupgeom, materialPared);
          paredfizqup.position.set(-85, 6+ysize2, -20+0.5*zsize);
	  Piso2.add(paredfizqup);
	  
	  var paredAizqup = new THREE.Mesh(paredfizqupgeom, materialPared);
          paredAizqup.position.set(-85, 6+ysize2, -zsize/2);
	  Piso2.add(paredAizqup);


	  var paredfbalcongeom = new THREE.BoxGeometry(60 + gruesoPared, 12, gruesoPared);
	  var paredfbalcon = new THREE.Mesh(paredfbalcongeom, materialPared);
          paredfbalcon.position.set(-30, 6+ysize2, 0.5*zsize);
	  Piso2.add(paredfbalcon);

	  
	  //half size sala baja
	  var doorWide=10;
	  var paredAtrasgeom = new THREE.BoxGeometry(50-doorWide, ysize2, gruesoPared);
          var paredatras2 = new THREE.Mesh(paredAtrasgeom, materialPared);
          paredatras2.position.set(-85-doorWide/2, 0.5*ysize2, -0.5*zsize);
	  Piso1.add(paredatras2);
	  var paredUpizq2 = new THREE.Mesh(paredAtrasgeom, materialPared);
          paredUpizq2.position.set(-85-doorWide/2, 1.5*ysize2, 0.25*zsize-10);
	  Piso2.add(paredUpizq2);


	  // pared baño
	  var paredbañogeom = new THREE.BoxGeometry(30+gruesoPared, ysize, gruesoPared);
          var paredbaño = new THREE.Mesh(paredbañogeom, materialPared);
          paredbaño.position.set(-45, 0.5*ysize, -0.5*zsize);
	  Piso1.add(paredbaño);
          var paredbaño2 = new THREE.Mesh(paredbañogeom, materialPared);
          paredbaño2.position.set(-45, 0.5*ysize, -0.25*zsize);
	  Piso1.add(paredbaño2);

	  var paredbaño3geom = new THREE.BoxGeometry(20, ysize, gruesoPared);
	  var paredbaño3 = new THREE.Mesh(paredbaño3geom, materialPared);
          paredbaño3.position.set(-50, 0.5*ysize, -0.375*zsize);
	  Piso1.add(paredbaño3);


	  var paredcentrobañogeom = new THREE.BoxGeometry(gruesoPared, ysize,  0.25*zsize-20);
	  var paredcentrobaño = new THREE.Mesh(paredcentrobañogeom, materialPared);
          paredcentrobaño.position.set(-40, 0.5*ysize, -0.375*zsize);
	  Piso1.add(paredcentrobaño);

	  
	  var paredbañoEgeom = new THREE.BoxGeometry(gruesoPared, ysize,  16);
	  var paredbañoE = new THREE.Mesh(paredbañoEgeom, materialPared);
          paredbañoE.position.set(-30, 0.5*ysize, -0.5*zsize+8);
	  Piso1.add(paredbañoE);
	  var paredbañoE2 = new THREE.Mesh(paredbañoEgeom, materialPared);
          paredbañoE2.position.set(-30, 0.5*ysize, -0.25*zsize-8);
	  Piso1.add(paredbañoE2);


	  
	  var paredEgeom = new THREE.BoxGeometry(gruesoPared, ysize2,  10+gruesoPared);
	  var paredE2 = new THREE.Mesh(paredEgeom, materialPared);
          paredE2.position.set(-30, 0.5*ysize2, 0.5*zsize-20-5);
	  Piso1.add(paredE2);

	  var paredbalconEgeom = new THREE.BoxGeometry(gruesoPared, 12,  20+gruesoPared);
	  var paredbalconE2 = new THREE.Mesh(paredbalconEgeom, materialPared);
          paredbalconE2.position.set(-60, 6+ysize2, 0.5*zsize-10);
	  Piso2.add(paredbalconE2);
	  



	  var paredbarandaUpgeom = new THREE.BoxGeometry(gruesoPared, 12,  16+gruesoPared);
	  var paredbarandaUp = new THREE.Mesh(paredbarandaUpgeom, materialLadrillo);
          paredbarandaUp.position.set(-45, 6+ysize, -26-8);
	  Piso2.add(paredbarandaUp);
	  
	  var paredbarandaMedgeom = new THREE.BoxGeometry(gruesoPared, 14,  36+gruesoPared);
	  var paredbarandaMed = new THREE.Mesh(paredbarandaMedgeom, materialLadrillo);
          paredbarandaMed.position.set(-30, 4.5+ysize2, 6);
	  Piso2.add(paredbarandaMed);


	  var paredbigMedgeom = new THREE.BoxGeometry(gruesoPared, ysize+2.5,  30+gruesoPared);
	  var paredbigMed = new THREE.Mesh(paredbigMedgeom, materialLadrillo);
          paredbigMed.position.set(-30, ysize/2+ysize2-1.25, 40-1);
	  Piso2.add(paredbigMed);

	  
	  var paredbarandaEsc0geom = new THREE.BoxGeometry(gruesoPared, 12,  2+16+gruesoPared);
	  var paredbarandaEsc0 = new THREE.Mesh(paredbarandaEsc0geom, materialLadrillo);
          paredbarandaEsc0.position.set(-30, 6, -19.5);
	  Piso1.add(paredbarandaEsc0);
	  
	  
	  var paredbarandaEscgeom = new THREE.BoxGeometry(gruesoPared, 10+14,  2+16+gruesoPared);
	  var paredbarandaEsc = new THREE.Mesh(paredbarandaEscgeom, materialLadrillo);
          paredbarandaEsc.position.set(-30, 5+7, -26-8);
	  Piso1.add(paredbarandaEsc);
	  var paredbarandaEsc45 = new THREE.Mesh(paredbarandaEscgeom, materialLadrillo);
          paredbarandaEsc45.position.set(-45, 5+7, -26+6);
	  Piso1.add(paredbarandaEsc45);


	  var alturaD= 12*3/3.6;
	  var largoz=15;
          var barandaDgeom = new THREE.BoxGeometry(gruesoPared, alturaD,  60);
          var cutboxgeom = new THREE.BoxGeometry(40,40,40);

	  var barandaD = new THREE.Mesh(barandaDgeom);
          var cutbox = new THREE.Mesh(cutboxgeom);
          barandaD.position.set(0, alturaD/2, 0);
	  barandaD.rotateX(0.62); //arctan(2/3)
          cutbox.position.set(0, 0, 20);
         
          var barandaCSG = THREE.CSG.fromMesh(barandaD);
          var boxCSG = THREE.CSG.fromMesh(cutbox);
          var result1 = barandaCSG.subtract(boxCSG);
	  cutbox.position.set(0, 10, -20-largoz);
          var boxCSG2 = THREE.CSG.fromMesh(cutbox);
          //boxCSG.position.set(0, 0, -largoz-10);
          var result2 = result1.subtract(boxCSG2);
          var diag = THREE.CSG.toMesh(result2);
	  diag.material = materialLadrillo;

	  var diagrotated=diag.clone();
	  diagrotated.rotateY(2*pihalf);
	  diagrotated.position.set(-45, 13, -largoz-19.5+8+1-3);
	  Piso1.add(diagrotated);
	  


	  diag.position.set(-30, 2, -19.5+8+2);
	  
	  Piso1.add(diag);

	  var diagUp=diag.clone();
	  diagUp.position.set(-30, ysize2, -19.5+8+1);
	  Piso2.add(diagUp);


	  var diagUp45=diag.clone();
	  diagUp45.position.set(-45, ysize2, -19.5+8+1);
	  Piso2.add(diagUp45);
	  
	  
	  //var paredcentroAgeom = new THREE.BoxGeometry(gruesoPared, ysize, 0.5*zsize);
	  var paredAgeom = new THREE.BoxGeometry(gruesoPared, ysize, 0.5*zsize);
	  var paredcentroA = new THREE.Mesh(paredAgeom, materialPared);
          paredcentroA.position.set(0, 0.5*ysize, -0.25*zsize);
	  Piso1.add(paredcentroA);
	  var paredA = new THREE.Mesh(paredAgeom, materialPared);
          paredA.position.set(-60, 0.5*ysize, -0.25*zsize);
	  Piso1.add(paredA);

	  var paredAup = new THREE.Mesh(paredAgeom, materialPared);
          paredAup.position.set(-60, 0.5*ysize+ysize2, -0.25*zsize);
	  Piso2.add(paredAup);
	  


	  var paredBgeom = new THREE.BoxGeometry(gruesoPared, ysize, 66);
	  var paredcentroB = new THREE.Mesh(paredBgeom, materialPared);
          paredcentroB.position.set(0, 0.5*ysize, 0.5*zsize-33);
	  Piso1.add(paredcentroB);

	  var paredBgeomUp = new THREE.BoxGeometry(gruesoPared, ysize, 46);
	  var paredcentroBUp = new THREE.Mesh(paredBgeomUp, materialPared);
          paredcentroBUp.position.set(0, 1.5*ysize, 0.5*zsize-23);
	  Piso2.add(paredcentroBUp);

	  //zsize/2-26
	  var paredBgeomUp2 = new THREE.BoxGeometry(gruesoPared, 12, zsize/2);
	  var paredcentroBUp2 = new THREE.Mesh(paredBgeomUp2, materialPared);
          paredcentroBUp2.position.set(0, 6+ysize, zsize/4-26);
	  Piso2.add(paredcentroBUp2);


	  

	  

	  var paredB2geom = new THREE.BoxGeometry(gruesoPared, ysize2, gruesoPared+66-20);
	  var paredB2 = new THREE.Mesh(paredB2geom, materialPared);
          paredB2.position.set(-60, 0.5*ysize2, 0.5*zsize-33-10);
	  Piso1.add(paredB2);
	  
	  var paredB2geom = new THREE.BoxGeometry(gruesoPared, ysize, gruesoPared+66-20);
	  var paredB2up = new THREE.Mesh(paredB2geom, materialPared);
          paredB2up.position.set(-60, ysize2+0.5*ysize, 0.5*zsize-33-10);
	  Piso2.add(paredB2up);




	  
	  ////////////////

	  
	  var bibliogeom = new THREE.BoxGeometry(50, 10, 8);
	  var biblioup = new THREE.Mesh(bibliogeom, materialBiblio);
          biblioup.position.set(55, ysize+5, -20);
	  Piso2.add(biblioup);
	  var biblioup2 = new THREE.Mesh(bibliogeom, materialBiblio);
          biblioup2.position.set(55, ysize+5, 60);
	  Piso2.add(biblioup2);

	  
	  var biblioBgeom = new THREE.BoxGeometry(8, 10, 10);
	  var biblioupB = new THREE.Mesh(biblioBgeom, materialBiblio);
          biblioupB.position.set(60, ysize+5, 35);
	  Piso2.add(biblioupB);
	  var biblioupB2 = new THREE.Mesh(biblioBgeom, materialBiblio);
          biblioupB2.position.set(40, ysize+5, 10);
	  Piso2.add(biblioupB2);
	  var biblioupB3 = new THREE.Mesh(biblioBgeom, materialBiblio);
          biblioupB3.position.set(60, ysize+5, 30);
	  Piso2.add(biblioupB3);



	  var lockergeom = new THREE.BoxGeometry(4, 20, 30);
	  var locker = new THREE.Mesh(lockergeom, materialGris);
          locker.position.set(-2, 10, 15+28);
	  Piso1.add(locker);


	  

	  //////////////////
	  //special box
	  var blackBoxsmall = new THREE.BoxGeometry(3, 3, 3);
	  var boxsmall = new THREE.Mesh(blackBoxsmall);	  
	  boxsmall.material= materialNegro;
	  var boxsmalldiag=boxsmall.clone();
	  boxsmalldiag.rotateX(-0.62);
	  
	  boxsmall.position.set(3, 20, -0.5*zsize+20);
	  boxsmall.storynumber=22;
          boxsmall.story=historias.h22;
          Piso1.add(boxsmall);
	  boxes=[boxsmall];


	  boxsmalldiag.storynumber=11;
          boxsmalldiag.story=historias.h11;
          boxsmalldiag.position.set(-45, 26, -28);
          Piso1.add(boxsmalldiag);
	  targetList.push(boxsmalldiag);


	  var boxsmall2=boxsmall.clone();
	  boxsmall2.storynumber=2;
	  boxsmall2.story=historias.h2;
	  boxsmall2.position.set(-66, 10, -37-zsize/2);
          Piso1.add(boxsmall2);
	  targetList.push(boxsmall2);

	  var boxsmallbla=boxsmall.clone();
	  boxsmallbla.storynumber=5;
          boxsmallbla.story=historias.h5;
          boxsmallbla.position.set(-62, ysize2+14, -12);
          Piso2.add(boxsmallbla);
	  targetList.push(boxsmallbla);


	  
	  var boxsmall6=boxsmall.clone();
	  boxsmall6.storynumber=6;
          boxsmall6.story=historias.h6;
          boxsmall6.position.set(60, 10+ysize, 35);
          Piso2.add(boxsmall6);
	  targetList.push(boxsmall6);
	  

	  // storyboxes
	  var boxsmall7=boxsmall.clone();
	  boxsmall7.storynumber=7;
          boxsmall7.story=historias.h7;
          boxsmall7.position.set(-62, 16, 38);
          Piso1.add(boxsmall7);
	  targetList.push(boxsmall7);



	  



	  var boxsmall08=boxsmall.clone();
	  boxsmall08.storynumber=8;
          boxsmall08.story=historias.h8;
          boxsmall08.position.set(xsize-3, 10+ysize, 50);
          Piso2.add(boxsmall08);
	  targetList.push(boxsmall08);
	  

	  
	  var boxsmall09=boxsmall.clone();
	  boxsmall09.storynumber=09;
          boxsmall09.story=historias.h9;
          boxsmall09.position.set(-107, 10, 10);
          Piso1.add(boxsmall09);
	  targetList.push(boxsmall09);



	

	  var boxsmall12=boxsmall.clone();
	  boxsmall12.storynumber=12;
          boxsmall12.story=historias.h12;
          boxsmall12.position.set(-45, 10+ysize, -zsize/2+20);
          Piso2.add(boxsmall12);
	  targetList.push(boxsmall12);





	  var boxsmall15=boxsmall.clone();
	  boxsmall15.storynumber=15;
          boxsmall15.story=historias.h15;
          boxsmall15.position.set(-108, ysize2+10, -40);
          Piso2.add(boxsmall15);
	  targetList.push(boxsmall15);



	  var boxsmall16=boxsmall.clone();
	  boxsmall16.storynumber=16;
          boxsmall16.story=historias.h16;
          boxsmall16.position.set(-60, 13, -zsize/2-20);
          Piso1.add(boxsmall16);
	  targetList.push(boxsmall16);

	  var boxsmall18=boxsmall.clone();
	  boxsmall18.storynumber=18;
          boxsmall18.story=historias.h18;
          boxsmall18.position.set(-4, 16, 32);
          Piso1.add(boxsmall18);
	  targetList.push(boxsmall18);


	  var boxsmall19=boxsmall.clone();
	  boxsmall19.storynumber=19;
	  boxsmall19.story=historias.h19;
          boxsmall19.position.set(-28, 12, -20);
          Piso1.add(boxsmall19);
	  targetList.push(boxsmall19);


	  var boxsmall20=boxsmall.clone();
	  boxsmall20.storynumber=20;
          boxsmall20.story=historias.h20;
          boxsmall20.position.set(2, 12, -20);
          Piso1.add(boxsmall20);
	  targetList.push(boxsmall20);


	  var boxsmall21=boxsmall.clone();
	  boxsmall21.storynumber=21;
          boxsmall21.story=historias.h21;
          boxsmall21.position.set(30, 10+ysize, 60);
          Piso2.add(boxsmall21);
	  targetList.push(boxsmall21);


	  
	  var boxsmall24=boxsmall.clone();
	  boxsmall24.storynumber=24;
          boxsmall24.story=historias.h24;
          boxsmall24.position.set(-3, 10, -16);
          Piso1.add(boxsmall24);
	  targetList.push(boxsmall24);






	  
	  
	  var cyborgSquare = new THREE.PlaneGeometry(8, 8);
	  cyborg = new THREE.Mesh(cyborgSquare, Proyeccion1);
          cyborg.position.set(3, 17, -0.5*zsize+20);
	  scene.add(cyborg);


	  var ventana1geom = new THREE.PlaneGeometry(50, 30);
	  var ventana1 = new THREE.Mesh(ventana1geom, materialCristal);
          ventana1.position.set(25+20,15+10,zsize/2);
	  Piso1.add(ventana1);
	  var ventana1Up = new THREE.Mesh(ventana1geom, materialCristal);
          ventana1Up.position.set(25+20,45+10,zsize/2);
	  Piso2.add(ventana1Up);

	  
	  var ventanaf2geom = new THREE.PlaneGeometry(80, ysize2-10);
	  var ventanaf2 = new THREE.Mesh(ventanaf2geom, materialCristal);
          ventanaf2.position.set(-70,ysize2/2+5,-20+zsize/2);
	  Piso1.add(ventanaf2);

	  var ventanaf2Upgeom = new THREE.PlaneGeometry(50, ysize2-10);
	  var ventanaf2Up = new THREE.Mesh(ventanaf2Upgeom, materialCristal);
          ventanaf2Up.position.set(-85,1.5*ysize2+5,-20+zsize/2);
	  Piso2.add(ventanaf2Up);

	  var ventanaAUp = new THREE.Mesh(ventanaf2Upgeom, materialCristal);
          ventanaAUp.position.set(-85,1.5*ysize2+5,-zsize/2);
	  Piso2.add(ventanaAUp);

	  var ventanaAtrasUpgeom = new THREE.PlaneGeometry(30, ysize2);
	  var ventanaAtrasUp = new THREE.Mesh(ventanaAtrasUpgeom, materialCristal);
          ventanaAtrasUp.position.set(-15,0.5*ysize2+ysize,-zsize/2);
	  Piso2.add(ventanaAtrasUp);
	  
	  //0.5*zsize-33-10
	  
	  var ventanaUp2geom = new THREE.PlaneGeometry(30, ysize-12);
	  var ventanaUp2 = new THREE.Mesh(ventanaUp2geom, materialCristal);
          ventanaUp2.position.set(-15, ysize2+ysize/2+6,zsize/2-36);
	  Piso2.add(ventanaUp2);
	  var ventanaUp2compugeom = new THREE.PlaneGeometry(30, ysize-12);
	  var ventanaUp2compu = new THREE.Mesh(ventanaUp2compugeom, materialCristal);
          ventanaUp2compu.position.set(-15, ysize+ysize/2+6,-26);
	  Piso2.add(ventanaUp2compu);

	  //muro del tercer piso, junto a la escalera
	  var muroAtrasCompuUpgeom = new THREE.BoxGeometry(30+gruesoPared, ysize2-4,gruesoPared);
	  var muroAtrasCompuUp = new THREE.Mesh(muroAtrasCompuUpgeom, materialPared);
          muroAtrasCompuUp.position.set(-45, 0.5*ysize2+ysize-2,-zsize/2);
	  Piso2.add(muroAtrasCompuUp);



	  var muroUp2geom = new THREE.BoxGeometry(30+gruesoPared, 12,gruesoPared);
	  var muroUp2 = new THREE.Mesh(muroUp2geom, materialLadrillo);
          muroUp2.position.set(-15, ysize2+6,zsize/2-36);
	  Piso2.add(muroUp2);
	  var muroUp2compu = new THREE.Mesh(muroUp2geom, materialLadrillo);
          muroUp2compu.position.set(-15, ysize+6,-26);
	  Piso2.add(muroUp2compu);


	  var muroUpgeom = new THREE.BoxGeometry(30, ysize,gruesoPared);
	  var muroUp = new THREE.Mesh(muroUpgeom, materialLadrillo);
          muroUp.position.set(-45, ysize2+ysize/2,24);
	  Piso2.add(muroUp);


	  var muroUp3geom = new THREE.BoxGeometry(15, ysize2, gruesoPared);
	  var muroUp3 = new THREE.Mesh(muroUp3geom, materialPared);
          muroUp3.position.set(-15/2-45, ysize+ysize2/2, -26-16);
	  Piso2.add(muroUp3);


	  

	  var muroUpgeom = new THREE.BoxGeometry(30, ysize,gruesoPared);
	  var muroUp = new THREE.Mesh(muroUpgeom, materialPared);
          muroUp.position.set(-45, ysize2+ysize/2,24);
	  Piso2.add(muroUp);


	  var muroPatioGeometry = new THREE.BoxGeometry(2*xsize+10, ysize, gruesoPared);
	  var muroPatio = new THREE.Mesh(muroPatioGeometry, materialPared);
          muroPatio.position.set(-5, ysize/2, -zsize/2-40);
	  Piso1.add(muroPatio);


	  var muroPatiolatGeometry = new THREE.BoxGeometry(gruesoPared, ysize, 40);
	  var muroPatioizq = new THREE.Mesh(muroPatiolatGeometry, materialPared);
          muroPatioizq.position.set(-xsize-10, ysize/2, -zsize/2-20);
	  Piso1.add(muroPatioizq);
	  var muroPatioder = new THREE.Mesh(muroPatiolatGeometry, materialPared);
          muroPatioder.position.set(xsize, ysize/2, -zsize/2-20);
	  Piso1.add(muroPatioder);

	  var muroPatioCGeometry = new THREE.BoxGeometry(gruesoPared, 12, 40);
	  var muroPatioC = new THREE.Mesh(muroPatioCGeometry, materialPared);
          muroPatioC.position.set(-60, 6, -zsize/2-20);
	  Piso1.add(muroPatioC);
	  
          //columns
	  var mycylindergeom = new THREE.CylinderGeometry( 2, 2,ysize2, 24);
	  var mycylinder = new THREE.Mesh(mycylindergeom, materialPared);
          mycylinder.position.set(-30,ysize2/2,-3+zsize/2);
	  Piso1.add(mycylinder);
	  var mycylinder2 = new THREE.Mesh(mycylindergeom, materialPared);
          mycylinder2.position.set(-60+3,ysize2/2,-3+zsize/2);
	  Piso1.add(mycylinder2);
	  
	  
	  scene.add(Piso1);
	  scene.add(Piso2);
	  
	  //not yet


	  
	  var bombiGeometry = new THREE.SphereGeometry(1.5, 15, 15);

      
	  
	  
	  
	  
	  
	  // initialize object to perform world/screen calculations
	  projector = new THREE.Projector();
	  
	  // when the mouse moves, call the given function
	  document.addEventListener( 'mousedown', onDocumentMouseDown, false );


 






	  camera.position.x = 0;
          camera.position.y = 300;
          camera.position.z = 10;
          camera.lookAt(origin);
      }



/////////////////////////

      
      function animate() {
          requestAnimationFrame(animate);
          controls.update();
	  if (usevideo==1)  {
	      videoTexture.needsUpdate=true;
	      //update();
	  }
          render();
	  
      }

      var vistaentrada = new THREE.Vector3(-20, 15, -zsize/2);
      var vistaauditorio = new THREE.Vector3(30, 15, 0);

      

      
      //function render() {
	  //cube[0].rotation.x += 0.01;
	  //cube[0].rotation.y += 0.01;
	  //cube[2].rotation.x += 0.01;
	  //cube[2].rotation.y += 0.01;
	  //cube.rotation.x += 0.01;
	  //cube.rotation.y += 0.01;
	  //renderer.render(scene, camera);
      //}

      document.onkeydown=function(e)
      {
	  if ( e.keyCode==80)//p
	      console.log("p")
	      camera.lookAt(vistaentrada);
	      //video.play();
	  
	  if ( e.keyCode==32 )// space
	      video.pause();
	  
	  if ( e.keyCode==83 ) // s, stop video
	  {
	      camera.lookAt(vistaauditorio);
	      //video.pause();
	      //video.currentTime = 0;
	  }
	  
	  if ( e.keyCode==82 ) //r rewind:
	      //video.currentTime = 0;
	      controls.saveState();
	  
	  if ( e.keyCode==84 ) // t
	      controls.reset();

	  if ( e.keyCode==85 ) {// t
	      console.log("key u");
	      scene.remove(Piso2);
	  }
	  //controls.update();
	  //stats.update();
      }


      
      
      function render() {
	  if (usevideo==1)
	  {	
	      if ( video.readyState === video.HAVE_ENOUGH_DATA ) 
	      {
		  videoImageContext.drawImage( video, 0, 0 );
		  if ( videoTexture ) 
		      videoTexture.needsUpdate = true;
	      }

	  }
      
	  renderer.render( scene, camera );
      }


      function onDocumentMouseDown( event ) {
	  // the following line would stop any other event handler from firing
	  // (such as the mouse's TrackballControls)
	  // event.preventDefault()
	  
	  console.log("Click.");
	  
	  // update the mouse variable
	  mouse.x = ( event.clientX / window.innerWidth ) * 2 - 1;
	  mouse.y = - ( event.clientY / window.innerHeight ) * 2 + 1;
	  
	  // find intersections
	  
	  // create a Ray with origin at the mouse position
	  //   and direction into the scene (camera direction)
	  var vector = new THREE.Vector3( mouse.x, mouse.y, 1 );
	  projector.unprojectVector( vector, camera );
	  var ray = new THREE.Raycaster( camera.position, vector.sub( camera.position ).normalize() );

	  // create an array containing all objects in the scene with which the ray intersects

	  for(var i = 0, size = targetList.length; i < size ; i++){
	      var item = targetList[i];
	      var targetl2=[];
	      targetl2.push(item)
	      var intersects = ray.intersectObjects( targetl2);
	      if ( intersects.length > 0 ) {
		  console.log("historia número "+ item.storynumber);
		  camera.lookAt(item.position);
		  controls.update();
		  document.getElementById('story').innerHTML =item.storynumber+': '+item.story.title;
		  //console.log(item.position);
	      } 
	  }
	  var intersects2 = ray.intersectObjects( boxes );
	
	  // if there is one (or more) intersections
	  if ( intersects2.length > 0 ) {
	      console.log("Hit @ " +  2  );
	      
	      togglePiso2()
	      // controls.maxDistance=200;
	      console.log(isvideoplaying);


	      // change the color of the closest face.
	      //intersects[ 0 ].face.color.setRGB( 0.8 * Math.random() + 0.2, 0, 0 ); 
	      //
	      //intersects[ 0 ].object.geometry.colorsNeedUpdate = true;
	  }
      }



      
      var isvideoplaying=0;

      function toggleVideoView()
      {
	  if ( isvideoplaying==0 ) //play video
	  {
	      video.play();
	      isvideoplaying=1;
	      //scene.add(cyborg);
	  }
	  else {
	      if( isvideoplaying==1 ) // pause video
	      {
		  video.pause();
		  isvideoplaying=0;
		  //scene.remove(cyborg);
	      }
	  }
	  
      }

      var verPiso2=1;

      function togglePiso2(scene, piso2)
      {
	  if ( verPiso2==0 ) //play video
	  {
	      scene.add(Piso2);
	      verPiso2=1;
	      console.log(verPiso2);
	  }
	  else {
	      if( isvideoplaying==1 ) // pause video
	      {
		  scene.remove(piso2);
		  verPiso2=0;
	      }	
	  }
	  
      }


      
    </script>
    <div class="basicmenu">
      <img src="images/cyborgshaman.jpg/50x50" onClick="togglePiso2(scene,Piso2)"> 
      <h4 href="https://elcyborgchaman.pythonanywhere.com/">El Cyborg Chamán </h4>
      <p>Biblioteca Pública de Suba Francisco José de Caldas,<br>
      Carrera 92 No. 146 C - 24
      </p>


      <a id='button'  onClick="togglePiso2(scene, Piso2)"> Piso 2 </a>
      <a href="https://emersonjleon.github.io/emersonjleon/historiasCyborg.txt">Historias de la exposición</a>

      <p id="story"></p>
    </div>
</body>

</html>

